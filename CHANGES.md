# æ¨¡æ¿æ”¹è¿›è®°å½•

## v2.0 - éä¾µå…¥å¼è®¾è®¡ (2024-11-16)

### ğŸ¯ æ ¸å¿ƒæ”¹è¿›

å°†ä¼ ç»Ÿçš„ä¾µå…¥å¼è®¾è®¡æ”¹ä¸ºéä¾µå…¥å¼è®¾è®¡ï¼Œæ‰€æœ‰éƒ¨ç½²æ–‡ä»¶éš”ç¦»åˆ° `.deploy/` ç›®å½•ã€‚

### ğŸ“ ç»“æ„å˜åŒ–

#### ä¹‹å‰ï¼ˆv1.0 - ä¾µå…¥æ€§ï¼‰
```
project-root/
â”œâ”€â”€ Dockerfile              # æ··åœ¨æ ¹ç›®å½•
â”œâ”€â”€ .dockerignore
â”œâ”€â”€ Makefile
â”œâ”€â”€ .github/
â”‚   â””â”€â”€ workflows/
â”‚       â””â”€â”€ build-and-deploy.yml
â”œâ”€â”€ terraform/
â”‚   â”œâ”€â”€ terraform.tf
â”‚   â””â”€â”€ main.tf
â””â”€â”€ ... é¡¹ç›®æ–‡ä»¶
```

#### ç°åœ¨ï¼ˆv2.0 - éä¾µå…¥æ€§ï¼‰
```
project-root/
â”œâ”€â”€ .deploy.yml             # å”¯ä¸€é…ç½®æ–‡ä»¶
â”œâ”€â”€ .copier-answers.yml     # Copier è®°å½•
â”œâ”€â”€ .deploy/                # æ‰€æœ‰éƒ¨ç½²æ–‡ä»¶éš”ç¦»
â”‚   â”œâ”€â”€ Dockerfile
â”‚   â”œâ”€â”€ .dockerignore
â”‚   â”œâ”€â”€ Makefile
â”‚   â”œâ”€â”€ README.md
â”‚   â”œâ”€â”€ .github/workflows/
â”‚   â”‚   â””â”€â”€ build-and-deploy.yml
â”‚   â”œâ”€â”€ terraform/
â”‚   â”‚   â”œâ”€â”€ terraform.tf
â”‚   â”‚   â””â”€â”€ main.tf
â”‚   â””â”€â”€ scripts/            # æ–°å¢ï¼šä¾¿æ·è„šæœ¬
â”‚       â”œâ”€â”€ build.sh
â”‚       â”œâ”€â”€ run.sh
â”‚       â”œâ”€â”€ docker-build.sh
â”‚       â”œâ”€â”€ docker-push.sh
â”‚       â””â”€â”€ deploy.sh
â””â”€â”€ ... é¡¹ç›®æ–‡ä»¶           # æ ¹ç›®å½•æ¸…çˆ½
```

### âœ¨ æ–°å¢åŠŸèƒ½

1. **ä¾¿æ·è„šæœ¬** (`.deploy/scripts/`)
   - `build.sh` - æ„å»ºäºŒè¿›åˆ¶
   - `run.sh` - æœ¬åœ°è¿è¡Œ
   - `docker-build.sh` - Docker æ„å»º
   - `docker-push.sh` - Docker æ¨é€
   - `deploy.sh` - Terraform éƒ¨ç½²

2. **é…ç½®é›†ä¸­** (`.deploy.yml`)
   - æ‰€æœ‰é…ç½®é›†ä¸­åœ¨ä¸€ä¸ªæ–‡ä»¶
   - æ¸…æ™°çš„ YAML æ ¼å¼
   - æ˜“äºæŸ¥æ‰¾å’Œä¿®æ”¹

3. **éƒ¨ç½²è¯´æ˜** (`.deploy/README.md`)
   - è¯¦ç»†çš„ä½¿ç”¨æ–‡æ¡£
   - è„šæœ¬ä½¿ç”¨ç¤ºä¾‹
   - æ•…éšœæ’æŸ¥æŒ‡å—

### ğŸ”§ æŠ€æœ¯æ”¹è¿›

1. **è·¯å¾„å¤„ç†**
   - Docker æ„å»ºä»é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œï¼š`docker build -f .deploy/Dockerfile .`
   - Makefile è‡ªåŠ¨å¤„ç†ç›¸å¯¹è·¯å¾„
   - è„šæœ¬è‡ªåŠ¨æ£€æµ‹é¡¹ç›®æ ¹ç›®å½•

2. **CI/CD é›†æˆ**
   - æ”¯æŒç¬¦å·é“¾æ¥ï¼š`ln -s ../../.deploy/.github/workflows/build-and-deploy.yml .github/workflows/`
   - æˆ–ç›´æ¥å¤åˆ¶æ–‡ä»¶
   - çµæ´»é€‚åº”ä¸åŒéœ€æ±‚

3. **æ¨¡å—åŒ–è®¾è®¡**
   - å¯é€‰ç»„ä»¶ï¼ˆTerraformã€Makefileï¼‰
   - æ¡ä»¶æ’é™¤æœºåˆ¶
   - æ˜“äºæ‰©å±•

### ğŸ“ ä½¿ç”¨æ–¹å¼å˜åŒ–

#### ä¹‹å‰
```bash
# ç›´æ¥åœ¨æ ¹ç›®å½•
docker build -t myapp .
make build
cd terraform && terraform apply
```

#### ç°åœ¨
```bash
# ä½¿ç”¨è„šæœ¬ï¼ˆæ¨èï¼‰
.deploy/scripts/docker-build.sh
.deploy/scripts/build.sh
.deploy/scripts/deploy.sh apply

# æˆ–ä½¿ç”¨ Makefile
cd .deploy && make docker-build
cd .deploy && make build
cd .deploy && make terraform-apply
```

### ğŸ‰ ä¼˜åŠ¿

- âœ… **éä¾µå…¥æ€§** - ä¸æ±¡æŸ“é¡¹ç›®æ ¹ç›®å½•
- âœ… **æ˜“äºç®¡ç†** - æ‰€æœ‰éƒ¨ç½²æ–‡ä»¶åœ¨ä¸€ä¸ªç›®å½•
- âœ… **ç®€å•å‘½ä»¤** - ä¾¿æ·è„šæœ¬ï¼Œæ— éœ€è®°å¿†å¤æ‚å‘½ä»¤
- âœ… **çµæ´»é…ç½®** - ä¸€ä¸ªé…ç½®æ–‡ä»¶ç®¡ç†æ‰€æœ‰è®¾ç½®
- âœ… **æ˜“äºæ¸…ç†** - åˆ é™¤ `.deploy/` å³å¯ç§»é™¤æ‰€æœ‰éƒ¨ç½²é…ç½®

### ğŸ”„ è¿ç§»æŒ‡å—

ä» v1.0 è¿ç§»åˆ° v2.0ï¼š

1. å¤‡ä»½ç°æœ‰é…ç½®
2. é‡æ–°åº”ç”¨æ¨¡æ¿ï¼š`copier copy <template-path> .`
3. å¤åˆ¶é…ç½®å€¼åˆ° `.deploy.yml`
4. åˆ é™¤æ—§çš„éƒ¨ç½²æ–‡ä»¶ï¼ˆå¯é€‰ï¼‰

### ğŸ“š ç›¸å…³æ–‡æ¡£

- `README.md` - å®Œæ•´ä½¿ç”¨æ–‡æ¡£
- `.deploy/README.md` - éƒ¨ç½²è¯¦ç»†è¯´æ˜
- `validate-template.sh` - æ¨¡æ¿éªŒè¯è„šæœ¬

---

## v1.0 - åˆå§‹ç‰ˆæœ¬

ä¼ ç»Ÿè®¾è®¡ï¼Œéƒ¨ç½²æ–‡ä»¶åˆ†æ•£åœ¨é¡¹ç›®æ ¹ç›®å½•ã€‚
